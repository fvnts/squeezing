%   ------------------------------------------------------------/
%   
%   squeezing regions
%
%   This is supplementary material for
%   https://arxiv.org/abs/1704.05840
%   coded by J Fuentes
%   jfuentes [at] fis.cinvestav.mx
%   ------------------------------------------------------------/

clc; clear; close;

%   ------------------

b0 = 1/10;

N  = 32;
d  = 1/N;
L  = length(0:d:2);
s  = zeros(L,2);

t  = linspace(-pi/2 + pi/64, pi/2 + pi/64, N);

%   ------------------

file = fopen('stability.dat','w');

%   ------------------
 
beta =  @ (b0,b,c,t)  ((12 - 196.*b - 102.*b.^2 - 2.*b.*c + 12.*b.^2.*b0 ... 
        - (6 + b.*(218 + c) + 3.*b.^2.*(-37 + 2.*b0)).*cos(2.*t) ...
        + 2.*(-6 + b.*(2 + c) + b.^2.*(3 - 6.*b0)).*cos(4.*t) ...
        + 6.*cos(6.*t) + 26.*b.*cos(6.*t) - 15.*b.^2.*cos(6.*t) ...
        + b.*c.*cos(6.*t) + 6.*b.^2.*b0.*cos(6.*t)) ... 
       .* (-36 - 724.*b + 210.*b.^2 + 22.*b.*c - 36.*b.^2.*b0 ...
        + (-102 + b.*(-1274 + 47.*c) + b.^2.*(735 - 102.*b0)).*cos(2.*t) ...
        - 2.*(78 - b.*(362 + 37.*c) + 3.*b.^2.*(35 + 26.*b0)).*cos(4.*t) ...
        + 294.*cos(6.*t) + 1274.*b.*cos(6.*t) - 735.*b.^2.*cos(6.*t) ...
        + 49.*b.*c.*cos(6.*t) + 294.*b.^2.*b0.*cos(6.*t)) ... 
        + 73728.*b.^2.*(-1 + (cos(t).^2.*(-60 + 100.*b - 210.*b.^2 ...
        + 2.*b.*c - 60.*b.^2.*b0 + (150 - b.*(374 + 7.*c) ... 
        + 15.*b.^2.*(7 + 10.*b0)).*cos(2.*t) - 2.*(66 + b.*(146 + c) ...
        + 3.*b.^2.*(-35 + 22.*b0)).*cos(4.*t) + 42.*cos(6.*t) ...
        + 182.*b.*cos(6.*t) - 105.*b.^2.*cos(6.*t) + 7.*b.*c.*cos(6.*t)...
        + 42.*b.^2.*b0.*cos(6.*t)).^2)/(147456.*b.^2)).*csc(t).^2)... 
       ./ (2.*(12 - 196.*b - 102.*b.^2 - 2.*b.*c + 12.*b.^2.*b0 ... 
        - (6 + b.*(218 + c) + 3.*b.^2.*(-37 + 2.*b0)).*cos(2.*t) ... 
        + 2.*(-6 + b.*(2 + c) + b.^2.*(3 - 6.*b0)).*cos(4.*t) ... 
        + 6.*cos(6.*t) + 26.*b.*cos(6.*t) - 15.*b.^2.*cos(6.*t) ...
        + b.*c.*cos(6.*t) + 6.*b.^2.*b0.*cos(6.*t)).^2);

%   ------------------

i = 1;
for b = -10:d:10
    for c = -10:d:10
        if  beta(b0,b,c,t) >= 0
            s(i,:) = [b c];
            fprintf(file,'%f %f\n',b,c);
        else 
            break
        end     
        i = i + 1;
    end
end

plot(s(:,1),s(:,2),'b.')
xlabel('b')
ylabel('c')

%xlim([1.5 2])
%ylim([-5 0])

%   ------------------

fclose(file);

